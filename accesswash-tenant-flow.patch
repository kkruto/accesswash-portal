From 1a2b3c4d5e6f7890abcdef1234567890abcdef12 Mon Sep 17 00:00:00 2001
From: ChatGPT <chatgpt@example.com>
Date: Sat, 9 Aug 2025 15:00:00 +0300
Subject: [PATCH] Implement tenant-first login flow with tenant subdomain JWT auth for AccessWASH

---
 vercel.json                                    |  11 +
 src/app/page.tsx                               |  50 ++++++
 src/app/portal/page.tsx                        |  40 +++++
 src/app/portal/select-utility/page.tsx         |  70 ++++++++
 src/app/portal/[tenant]/layout.tsx             |  35 ++++
 src/app/portal/[tenant]/login/page.tsx         |  65 ++++++++
 src/app/portal/[tenant]/dashboard/page.tsx     |  20 +++
 src/app/portal/[tenant]/staff-login/page.tsx   |  65 ++++++++
 src/app/portal/[tenant]/staff-dashboard/page.tsx | 20 +++
 src/app/layout.tsx                             |  25 +++
 src/components/AWLogo.tsx                      |  20 +++
 src/components/header.tsx                      |  30 ++++
 src/components/footer.tsx                      |  15 ++
 src/components/tenant-provider.tsx             |  18 ++
 src/lib/api.ts                                 | 180 ++++++++++++++++++++++++
 15 files changed, 864 insertions(+)
 create mode 100644 vercel.json
 create mode 100644 src/app/page.tsx
 create mode 100644 src/app/portal/page.tsx
 create mode 100644 src/app/portal/select-utility/page.tsx
 create mode 100644 src/app/portal/[tenant]/layout.tsx
 create mode 100644 src/app/portal/[tenant]/login/page.tsx
 create mode 100644 src/app/portal/[tenant]/dashboard/page.tsx
 create mode 100644 src/app/portal/[tenant]/staff-login/page.tsx
 create mode 100644 src/app/portal/[tenant]/staff-dashboard/page.tsx
 create mode 100644 src/app/layout.tsx
 create mode 100644 src/components/AWLogo.tsx
 create mode 100644 src/components/header.tsx
 create mode 100644 src/components/footer.tsx
 create mode 100644 src/components/tenant-provider.tsx
 create mode 100644 src/lib/api.ts

diff --git a/vercel.json b/vercel.json
new file mode 100644
--- /dev/null
+++ b/vercel.json
@@
+{
+  "rewrites": [
+    {
+      "source": "/",
+      "has": [
+        { "type": "host", "value": "(?<tenant>.+)\\.accesswash\\.org" }
+      ],
+      "destination": "/portal/:tenant"
+    }
+  ]
+}
